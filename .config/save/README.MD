I'm adding the codes here for now until I find a decent solution
